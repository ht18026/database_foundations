// *****PLEASE ENTER YOUR DETAILS BELOW*****
// T6-pat-mongo.mongodb.js

// Student ID: 34479791
// Student Name: Wang Xijia

//Comments for your marker:

// ===================================================================================
// Do not add new comments to this playground
// OR modify or remove any of the comments below (items marked with //)
// ===================================================================================

// Use (connect to) your database - you MUST update xyz001
// with your authcate username

use("xwan0458");

// (b)
// PLEASE PLACE REQUIRED MONGODB COMMAND TO CREATE THE COLLECTION HERE
// YOU MAY PICK ANY COLLECTION NAME
// ENSURE that your query is formatted and has a semicolon
// (;) at the end of this answer

// Drop collection
db.driverinfo.drop();

// Create collection and insert documents
db.driverinfo.insertMany([{"_id":2001,"name":"Pierre Martin","licence_num":"120501123456","no_of_trips":9,"suspended":"N","trips_info":[{"trip_id":1,"veh_vin":"1HGCM82633A987654","pick-up":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"01/10/2023 08:30","actual_datetime":"01/10/2023 08:45"},"drop off":{"location_id":103,"location_name":"Champ de Mars Arena","intended_datetime":"01/10/2023 09:00","actual_datetime":"01/10/2023 09:15"}},{"trip_id":22,"veh_vin":"1HGCM82633A210987","pick-up":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"03/08/2024 10:00","actual_datetime":"03/08/2024 10:15"},"drop off":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"03/08/2024 11:30","actual_datetime":"03/08/2024 11:45"}},{"trip_id":21,"veh_vin":"1HGCM82633A987654","pick-up":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"02/08/2024 10:00","actual_datetime":"02/08/2024 10:15"},"drop off":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"02/08/2024 10:30","actual_datetime":"02/08/2024 10:45"}},{"trip_id":20,"veh_vin":"1HGCM82633A987654","pick-up":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"02/10/2023 10:00","actual_datetime":"02/10/2023 10:15"},"drop off":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"02/10/2023 10:30","actual_datetime":"02/10/2023 10:45"}},{"trip_id":17,"veh_vin":"1HGCM82633A987654","pick-up":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"02/10/2023 08:30","actual_datetime":"02/10/2023 08:45"},"drop off":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"02/10/2023 10:30","actual_datetime":"02/10/2023 10:45"}},{"trip_id":13,"veh_vin":"1HGCM82633A321098","pick-up":{"location_id":104,"location_name":"Eiffel Tower Stadium","intended_datetime":"01/10/2023 20:00","actual_datetime":"01/10/2023 20:05"},"drop off":{"location_id":105,"location_name":"South Paris Arena","intended_datetime":"01/10/2023 20:30","actual_datetime":"01/10/2023 20:45"}},{"trip_id":10,"veh_vin":"1HGCM82633A987654","pick-up":{"location_id":103,"location_name":"Champ de Mars Arena","intended_datetime":"01/10/2023 17:00","actual_datetime":"01/10/2023 17:10"},"drop off":{"location_id":104,"location_name":"Eiffel Tower Stadium","intended_datetime":"01/10/2023 17:30","actual_datetime":"01/10/2023 17:40"}},{"trip_id":6,"veh_vin":"1HGCM82633A987654","pick-up":{"location_id":105,"location_name":"South Paris Arena","intended_datetime":"01/10/2023 14:00","actual_datetime":"01/10/2023 14:15"},"drop off":{"location_id":106,"location_name":"La Beaujoire Stadium","intended_datetime":"01/10/2023 14:30","actual_datetime":"01/10/2023 14:45"}},{"trip_id":3,"veh_vin":"1HGCM82633A987654","pick-up":{"location_id":104,"location_name":"Eiffel Tower Stadium","intended_datetime":"01/10/2023 10:00","actual_datetime":"01/10/2023 10:15"},"drop off":{"location_id":105,"location_name":"South Paris Arena","intended_datetime":"01/10/2023 10:30","actual_datetime":"01/10/2023 10:45"}}]}, 
{"_id":2002,"name":"Marie Dupont","licence_num":"34082A789012","no_of_trips":6,"suspended":"N","trips_info":[{"trip_id":2,"veh_vin":"1HGCM82633A876543","pick-up":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"01/10/2023 08:30","actual_datetime":"01/10/2023 08:45"},"drop off":{"location_id":103,"location_name":"Champ de Mars Arena","intended_datetime":"01/10/2023 09:00","actual_datetime":"01/10/2023 09:15"}},{"trip_id":23,"veh_vin":"1HGCM82633A432109","pick-up":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"03/08/2024 10:00","actual_datetime":"03/08/2024 10:15"},"drop off":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"03/08/2024 11:30","actual_datetime":"03/08/2024 11:45"}},{"trip_id":18,"veh_vin":"1HGCM82633A876543","pick-up":{"location_id":103,"location_name":"Champ de Mars Arena","intended_datetime":"02/10/2023 08:30","actual_datetime":"02/10/2023 08:45"},"drop off":{"location_id":104,"location_name":"Eiffel Tower Stadium","intended_datetime":"02/10/2023 09:30","actual_datetime":"02/10/2023 09:45"}},{"trip_id":15,"veh_vin":"1HGCM82633A543210","pick-up":{"location_id":106,"location_name":"La Beaujoire Stadium","intended_datetime":"01/10/2023 22:00","actual_datetime":"01/10/2023 22:10"},"drop off":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"01/10/2023 22:30","actual_datetime":"01/10/2023 22:50"}},{"trip_id":8,"veh_vin":"1HGCM82633A876543","pick-up":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"01/10/2023 15:00","actual_datetime":"01/10/2023 15:10"},"drop off":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"01/10/2023 15:30","actual_datetime":"01/10/2023 15:40"}},{"trip_id":5,"veh_vin":"1HGCM82633A654321","pick-up":{"location_id":103,"location_name":"Champ de Mars Arena","intended_datetime":"01/10/2023 12:00","actual_datetime":"01/10/2023 12:15"},"drop off":{"location_id":104,"location_name":"Eiffel Tower Stadium","intended_datetime":"01/10/2023 12:30","actual_datetime":"01/10/2023 12:45"}}]},                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
{"_id":2003,"name":"Louis Dubois","licence_num":"45112B654321","no_of_trips":5,"suspended":"N","trips_info":[{"trip_id":4,"veh_vin":"1HGCM82633A543210","pick-up":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"01/10/2023 11:00","actual_datetime":"01/10/2023 11:05"},"drop off":{"location_id":106,"location_name":"La Beaujoire Stadium","intended_datetime":"01/10/2023 11:30","actual_datetime":"01/10/2023 11:45"}},{"trip_id":19,"veh_vin":"1HGCM82633A543210","pick-up":{"location_id":104,"location_name":"Eiffel Tower Stadium","intended_datetime":"02/10/2023 09:00","actual_datetime":"02/10/2023 09:05"},"drop off":{"location_id":105,"location_name":"South Paris Arena","intended_datetime":"02/10/2023 09:30","actual_datetime":"02/10/2023 09:45"}},{"trip_id":16,"veh_vin":"1HGCM82633A654321","pick-up":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"01/10/2023 23:00","actual_datetime":"01/10/2023 23:05"},"drop off":{"location_id":104,"location_name":"Eiffel Tower Stadium","intended_datetime":"01/10/2023 23:30","actual_datetime":"01/10/2023 23:45"}},{"trip_id":9,"veh_vin":"1HGCM82633A654321","pick-up":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"01/10/2023 16:00","actual_datetime":"01/10/2023 16:15"},"drop off":{"location_id":103,"location_name":"Champ de Mars Arena","intended_datetime":"01/10/2023 16:30","actual_datetime":"01/10/2023 16:45"}},{"trip_id":7,"veh_vin":"1HGCM82633A543210","pick-up":{"location_id":106,"location_name":"La Beaujoire Stadium","intended_datetime":"01/10/2023 14:00","actual_datetime":"01/10/2023 14:05"},"drop off":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"01/10/2023 14:30","actual_datetime":"01/10/2023 14:50"}}]},                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
{"_id":2004,"name":"Antoine Lefevre","licence_num":"670495098765","no_of_trips":1,"suspended":"N","trips_info":[{"trip_id":11,"veh_vin":"1HGCM82633A543210","pick-up":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"01/10/2023 18:00","actual_datetime":"01/10/2023 18:05"},"drop off":{"location_id":105,"location_name":"South Paris Arena","intended_datetime":"01/10/2023 18:30","actual_datetime":"01/10/2023 18:45"}}]},                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
{"_id":2005,"name":"Sophie Bernard","licence_num":"89122a345678","no_of_trips":2,"suspended":"N","trips_info":[{"trip_id":12,"veh_vin":"1HGCM82633A876543","pick-up":{"location_id":101,"location_name":"Bordeaux Stadium","intended_datetime":"01/10/2023 19:00","actual_datetime":"01/10/2023 19:10"},"drop off":{"location_id":102,"location_name":"Bercy Arena","intended_datetime":"01/10/2023 19:30","actual_datetime":"01/10/2023 19:45"}},{"trip_id":14,"veh_vin":"1HGCM82633A987654","pick-up":{"location_id":105,"location_name":"South Paris Arena","intended_datetime":"01/10/2023 21:00","actual_datetime":"01/10/2023 21:05"},"drop off":{"location_id":106,"location_name":"La Beaujoire Stadium","intended_datetime":"01/10/2023 21:30","actual_datetime":"01/10/2023 21:45"}}]},                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
{"_id":2014,"name":"Claire Robert","licence_num":"55052a543210","no_of_trips":1,"suspended":"N","trips_info":[{"trip_id":100,"veh_vin":"1C4SDHCT9FC614231","pick-up":{"location_id":113,"location_name":"Olympic and Paralympic village","intended_datetime":"30/07/2024 12:30","actual_datetime":"30/07/2024 12:30"},"drop off":{"location_id":111,"location_name":"Porte de La Chapelle Arena","intended_datetime":"30/07/2023 14:00","actual_datetime":"30/07/2024 14:15"}}]},                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
]);

// List all documents you added
db.driverinfo.find().pretty();


// (c)
// PLEASE PLACE REQUIRED MONGODB COMMAND/S FOR THIS PART HERE
// ENSURE that your query is formatted and has a semicolon
// (;) at the end of this answer
db.driverinfo.find(
    {
        $or: [
            { "trips_info.drop off.location_name": "Champions Park" },
            { "trips_info.drop off.location_name": "Porte de La Chapelle Arena" }
        ]
    },
    {
        "name": 1,
        "licence_num": 1,
        "_id": 0
    }
).pretty();



// (d)
// PLEASE PLACE REQUIRED MONGODB COMMAND/S FOR THIS PART HERE
// ENSURE that your query is formatted and has a semicolon
// (;) at the end of this answer

// Show document before the new trip is added and the driver is suspended
db.driverinfo.find({ "_id": 2004 }).pretty();


// Add new trip and set the driver to suspended
db.driverinfo.updateOne(
    { "_id": 2004 },
    {
        $push: {
            "trips_info": {
                "trip_id": 50,
                "veh_vin": "1A2B3C4D5E6F7G8H9",
                "pick-up": {
                    "location_id": 117,
                    "location_name": "Tuileries Garden",
                    "intended_datetime": "10/08/2024 09:00",
                    "actual_datetime": "10/08/2024 09:00"
                },
                "drop off": {
                    "location_id": 118,
                    "location_name": "Sainte-Chapelle",
                    "intended_datetime": "10/08/2024 09:30",
                    "actual_datetime": "10/08/2024 09:30"
                }
            }
        }
    }
);
db.driverinfo.updateOne(
    { "_id": 2004 },
    {
        $set: { "suspended": "Y" }
    }
);


// Illustrate/confirm changes made
db.driverinfo.find({ "_id": 2004 }).pretty();

